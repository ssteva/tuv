<template>
  <require from="./ponuda.css"></require>
  <require from="aurelia-kendoui-bridge/datepicker/datepicker"></require>
  <require from="aurelia-kendoui-bridge/dropdownlist/dropdownlist"></require>
  <require from="aurelia-kendoui-bridge/numerictextbox/numerictextbox"></require>
  <require from="resources/elements/fajlovi"></require>
  <a href="javascript:void()" click.delegate="router.navigateBack()">
    <i class="material-icons md-36">arrow_back</i>
  </a>

  <br />
  <br />

  <div class="md-card">
    <div class="md-card-content">
      <div class="uk-grid uk-grid-divider" data-uk-grid-margin>
        <div class="uk-width-large-1-2 uk-width-medium-1-2 uk-width-small-1-1">
          <h3 if.bind="ponuda.id === 0" class="heading_a">${'Nova ponuda' & t}</h3>
          <h3 if.bind="ponuda.id !== 0" class="heading_a">${'Ponuda broj'& t} &nbsp;${ponuda.rbr} </h3>
          <br />
          <form  class="uk-form uk-form-horizontal">

            <div class="uk-form-row">
              <label class="uk-form-label" t="Klijent">Klijent</label>

              <div class="uk-form-controls">
                <ak-drop-down-list k-widget.two-way="cboKlijent"
                                   k-data-source.bind="klijenti"
                                   k-option-label="Odabrati..."
                                   k-data-text-field="naziv"
                                   k-data-value-field="id"
                                   k-filter="contains"
                                   k-on-select.delegate="onSelectKlijent($event.detail)"
                                   k-min-length="3"
                                   k-suggest="true"
                                   style="width: 100%"
                                   k-value.two-way="ponuda.klijent.id">

                </ak-drop-down-list>
              </div>

            </div>


            <div class="uk-form-row">
              <label class="uk-form-label" t="Opis posla">Opis posla</label>
              <div class="uk-form-controls">
                <textarea rows="4" cols="50" class="uk-width-1-1" value.bind="ponuda.opisPosla"></textarea>
              </div>
            </div>
            <div class="uk-form-row" if.bind="ponuda.id !== 0">
              <label class="uk-form-label" t="Redni broj">Redni broj</label>
              <div class="uk-form-controls">
                <input type="text" class="k-textbox" value.bind="ponuda.rbr" disabled.bind="ponuda.id !== 0" />
              </div>
            </div>
            <div class="uk-form-row" if.bind="klijent.id !== 0">
              <label class="uk-form-label" t="Broj">Broj</label>
              <div class="uk-form-controls">
                <input type="text" class="k-textbox" value.bind="ponuda.broj" disabled.bind="ponuda.id !== 0" style="width: 100%;" />
              </div>
            </div>

            <div class="uk-form-row">
              <label class="uk-form-label">${'Datum ponude' & t} </label>
              <div class="uk-form-controls">
                <input ak-datepicker="k-widget.two-way: cboDatumPonude; k-value.two-way: ponuda.datumPonude; k-format.bind:'dd.MM.yyyy'" />
              </div>
            </div>

            <div class="uk-form-row">
              <label class="uk-form-label" t="Zadužen(a) za ponudu">Zadužen(a) za ponudu</label>
              <div if.bind="!role.includes('Izvršilac')" class="uk-form-controls">
                <ak-drop-down-list k-option-label="Odabrati..."
                                   k-widget.two-way="cboZaduzenZaPonudu"
                                   k-data-source.bind="rukovodioci"
                                   k-data-text-field="naziv"
                                   k-on-select.delegate="onSelectZaduzenZaPonudu($event.detail)"
                                   k-data-value-field="id"
                                   style="width: 100%"
                                   k-value.two-way="ponuda.zaduzenZaPonudu.id">

                </ak-drop-down-list>
              </div>
              <div if.bind="role.includes('Izvršilac')" class="uk-form-controls">
                ${ponuda.korisnik.ime} ${ponuda.korisnik.prezime}
              </div>
            </div>
            <div class="uk-form-row">
              <label class="uk-form-label" t="Valuta">Valuta</label>
              <div class="uk-form-controls">
                <div class="dynamic_radio uk-margin-small-top">
                  <span class="icheck-inline">
                    <input type="radio" name="optValuta" id="RSD" value.bind="'RSD'" checked.bind="ponuda.valuta" data-md-icheck required />
                    <label class="uk-text-small inline-label" for="RSD">RSD</label>
                  </span>
                  <span class="icheck-inline">
                    <input type="radio" name="optValuta" id="EUR" model.bind="'EUR'" checked.bind="ponuda.valuta" data-md-icheck required />
                    <label class="uk-text-small inline-label" for="EUR">EUR</label>
                  </span>
                </div>
              </div>
            </div>


            <div class="uk-form-row">
              <label class="uk-form-label" t="Vrednost">Vrednost</label>
              <div class="uk-form-controls">
                <input type="number" ak-numerictextbox="k-widget.two-way: txtIznos;k-value.two-way: ponuda.vrednost;k-format.bind:'n2'; k-min.bind:1;k-max.bind:1000000;k-step.bind:10" />
              </div>
            </div>

            <div class="uk-form-row">
              <label class="uk-form-label" t="Ponuda prihvaćena">Ponuda prihvaćena</label>
              <div class="uk-form-controls dynamic_radio uk-margin-small-top">
                <span class="icheck-inline">
                  <input type="radio" name="optPonudaPrihvacena" id="da" model.bind="true" checked.bind="ponuda.prihvacena" data-md-icheck required />
                  <label class="uk-text-small inline-label" for="ne" t="Da">Da</label>
                </span>
                <span class="icheck-inline">
                  <input type="radio" name="optPonudaPrihvacena" id="ne" model.bind="false" checked.bind="ponuda.prihvacena" data-md-icheck required />
                  <label class="uk-text-small inline-label" for="ne" t="Ne">Ne</label>
                </span>
              </div>

            </div>
          </form>

          <!--<ul if.bind="ponuda.id !==0" class="md-list">
            <li>
              <div class="md-list-content">
                <h4 t="Ponuda - dokument"></h4>
                <input if.bind="ponudaDokument.length ===0" id="ponudaDokument" type="file" change.delegate="fileSelectedPonudaDokument($event)">
                <div show.bind="ponudaDokument.length>0">
                  <span class="md-list-heading"><a href.bind="'api/Dokument/' + ponudaDokument[0].id">${ponudaDokument[0].fileName}</a></span>
                  <div class="uk-margin-small-top">
                    <span data-uk-tooltip title="${'Datum postavke fajla' & t}" class="uk-margin-right">
                      <i class="material-icons">&#xE192;</i> <span class="uk-text-muted uk-text-small">${ponudaDokument[0].dateUploaded | datumVreme}</span>
                    </span>
                    <span data-uk-tooltip title="${'Datum fajla' & t}" class="uk-margin-right">
                      <i class="material-icons">&#xE192;</i> <span class="uk-text-muted uk-text-small">${ponudaDokument[0].dateLastModified | datumVreme}</span>
                    </span>
                    <span data-uk-tooltip title="${'Veličina' & t}" class="uk-margin-right">
                      <i class="material-icons">photo_size_select_large</i> <span class="uk-text-muted uk-text-small">${ponudaDokument[0].size} bytes</span>
                    </span>
                    <span data-uk-tooltip title="${'Obriši' & t}" class="uk-margin-right">
                      <a click.delegate="deletePonudaDokument(ponudaDokument[0].id)"><i class="material-icons">delete_forever</i></a>
                    </span>
                  </div>
                </div>
              </div>
            </li>
          </ul>-->
        </div>

        <div class="uk-width-large-1-2 uk-width-medium-1-2 uk-width-small-1-1">
          <fajlovi if.bind="ponuda.id !== 0" naslov="Dokumenta" entitet="Ponuda" entitetopis="PonudaDokument" entitetid.bind="ponuda.id" maksimum="2"></fajlovi>
        </div>

      </div>
      <br />
      <br />
      <button class="md-btn md-btn-primary md-btn-icon" href="javascript:void(0)" click.delegate="snimi()">
        <i class="uk-icon-save"></i>
        ${"Snimi" & t}
      </button>
    </div>

  </div>


</template>
